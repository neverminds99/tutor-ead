/**
 * Folha de Estilo Front-end do Tutor EAD
 * VERSÃO 2.3 - Estilos originais restaurados e organizados por partials.
 */

:root {
  /* A variável --main-color é injetada pelo PHP no header */
}

/* ========================================================================
   Estilos Globais e do Invólucro do Curso
   - Aplica-se a todas as páginas do template-curso.php
   ======================================================================== */

body.tutor-ead-page-body {
  font-family: Arial, sans-serif;
  margin: 0;
  padding: 0;
  background-color: #f9f9f9;
}

header.tutor-ead-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 20px;
  background-color: #fff;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.logo img { max-height: 50px; }
.search-bar { flex: 1; margin: 0 20px; padding: 8px; border: 1px solid #ccc; border-radius: 20px; }
.user-menu { position: relative; display: inline-block; }
.user-icon { cursor: pointer; font-size: 24px; }
.user-dropdown { display: none; position: absolute; right: 0; background: #fff; min-width: 150px; box-shadow: 0 8px 16px rgba(0,0,0,0.2); border: 1px solid #ddd; border-radius: 4px; z-index: 100; }
.user-dropdown a { display: block; padding: 10px 15px; color: #000; text-decoration: none; }
.user-dropdown a:hover { background: #f5f5f5; }

main {
  display: flex;
  flex-direction: row;
  padding: 20px;
}

/* ========================================================================
   Visão da Aula (Player) - para o partial `view-lesson-player.php`
   ======================================================================== */

.video-container {
  flex: 2;
  background: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  margin-right: 20px;
}
.video-player { width: 100%; position: relative; padding-bottom: 56.25%; background: #000; margin-bottom: 20px; }
.video-player iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
.video-container h1 { margin-top: 20px; font-size: 22px; }
.channel-info { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; margin-top: 10px; }
.channel-name img { max-height: 30px; vertical-align: middle; }
.video-actions { display: flex; align-items: center; gap: 10px; margin-top: 5px; }
.video-actions form { display: inline; }
.video-actions button, .video-actions a.back-to-course-btn { padding: 8px 12px; border: none; background: var(--main-color); color: #fff; cursor: pointer; border-radius: 4px; text-decoration: none; font-size: 14px; }
.video-actions button:hover, .video-actions a.back-to-course-btn:hover { opacity: 0.9; }
.progress-section { margin-top: 10px; padding: 10px; background: #e9ecef; border-radius: 6px; }
.progress-bar { width: 100%; height: 8px; background: #ddd; border-radius: 4px; margin-top: 6px; overflow: hidden; }
.progress-bar-fill { height: 100%; background: var(--main-color); border-radius: 4px; transition: width 0.5s ease-in-out; }
.lesson-detail { margin-top: 10px; }
.comments-section { margin-top: 20px; padding: 10px; background: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
.comment-input { display: flex; gap: 10px; margin-bottom: 10px; }
.comment { display: flex; justify-content: space-between; align-items: center; padding: 8px; border-bottom: 1px solid #ddd; }

/* Playlist na tela da aula (Estilos originais restaurados) */
.playlist-section { flex: 1; padding: 15px; background: #fff; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
.playlist-section .module-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.playlist-section .module-name { font-size: 18px; font-weight: bold; }
.playlist-section ul.lesson-list { list-style: none; padding: 0; margin: 0; }
.playlist-section li { display: flex; align-items: center; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px; transition: background-color 0.2s; }
.playlist-section li:hover { background-color: #f5f5f5; }
.playlist-section li a { display: flex; align-items: center; width: 100%; text-decoration: none; color: #333; }
.playlist-section li.current-lesson { background-color: #e8f4ff; border-color: var(--main-color); }
.playlist-section .thumbnail { width: 120px; height: 68px; margin-right: 15px; background-size: cover; background-position: center; border-radius: 4px; flex-shrink: 0; position: relative; }
.playlist-section .lesson-completed-icon { position: absolute; top: 4px; right: 4px; background: rgba(0, 0, 0, 0.7); color: #fff; padding: 2px 5px; border-radius: 3px; font-size: 10px; font-weight: bold; }
.playlist-section .lesson-title { font-size: 14px; flex-grow: 1; }
/* RESTAURADO: Estilos para aulas bloqueadas na playlist */
.playlist-section a.lesson-locked { opacity: 0.5; /* pointer-events: none; <-- REMOVIDO */ cursor: default; }

/* NOVO: Estilos para overlays na playlist */
.playlist-section li .thumbnail {
    position: relative; /* Torna a thumbnail um container para o overlay */
    overflow: hidden; /* Garante que o overlay não vaze */
}

.playlist-section .drip-overlay-playlist,
.playlist-section .lock-overlay-playlist {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(20, 20, 20, 0.85);
    color: white;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 5px;
    box-sizing: border-box;
    z-index: 2;
}

/* Ícone de relógio para playlist */
.playlist-section .drip-icon-clock-playlist {
    font-size: 1.2rem; /* Ícone menor */
    width: 1em;
    height: 1em;
    border: 0.1em solid currentColor;
    border-radius: 50%;
    position: relative;
    margin-bottom: 5px;
}
.playlist-section .drip-icon-clock-playlist::before,
.playlist-section .drip-icon-clock-playlist::after {
    content: '';
    position: absolute;
    background-color: currentColor;
    transform-origin: bottom center;
}
.playlist-section .drip-icon-clock-playlist::before { top: 0.2em; left: 0.45em; width: 0.1em; height: 0.3em; }
.playlist-section .drip-icon-clock-playlist::after { top: 0.15em; left: 0.45em; width: 0.1em; height: 0.35em; transform: rotate(120deg); }

/* Texto de liberação para playlist */
.playlist-section .drip-release-text-playlist {
    font-size: 0.65rem;
    font-weight: 600;
    line-height: 1.2;
    text-transform: uppercase;
}
.playlist-section .drip-days-number-playlist {
    font-size: 1rem;
    font-weight: 700;
    display: block; /* Coloca o número em uma linha separada */
}

/* Ícone de cadeado para playlist */
.playlist-section .lock-icon-padlock-playlist {
    position: relative;
    box-sizing: border-box;
    width: 14px;
    height: 11px;
    border-radius: 2px;
    background: currentColor;
    margin-bottom: 8px;
}
.playlist-section .lock-icon-padlock-playlist:before {
    content: '';
    position: absolute;
    box-sizing: border-box;
    top: -6px;
    left: 50%;
    transform: translateX(-50%);
    width: 10px;
    height: 7px;
    border-radius: 4px 4px 0 0;
    border: 2px solid currentColor;
    border-bottom: none;
}

/* Texto de bloqueio para playlist */
.playlist-section .lock-text-playlist {
    font-size: 0.7rem;
    font-weight: 600;
    line-height: 1.2;
}

/* Estilos de Tooltip para a Playlist */
.playlist-section li .tooltip-bubble {
    visibility: hidden;
    opacity: 0;
    background-color: #1d2327;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 10px;
    position: absolute;
    z-index: 10;
    transition: opacity 0.3s ease;
    font-size: 0.8rem;
    line-height: 1.4;
    font-weight: normal;
    pointer-events: none;
    width: 200px;
    bottom: 100%;
    left: 50%;
    margin-left: -100px;
    margin-bottom: 10px;
}

/* Flecha do balão */
.playlist-section li .tooltip-bubble::after {
    content: "";
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #1d2327 transparent transparent transparent;
}

/* Exibe o tooltip APENAS com a classe de visibilidade (controlada por JS) */
.playlist-section li.tooltip-visible .tooltip-bubble {
    visibility: visible;
    opacity: 1;
}

/* ========================================================================
   Visão Geral do Curso - para o partial `view-course-overview.php`
   ======================================================================== */
.course-overview-container { max-width: 1100px; margin: 20px auto; display: grid; grid-template-columns: 320px 1fr; gap: 30px; }
.course-info-block { background: #fff; border: 1px solid #e0e0e0; border-radius: 8px; padding: 20px; text-align: center; position: sticky; top: 40px; }
.course-cover { width: 100%; aspect-ratio: 16 / 9; object-fit: cover; border-radius: 6px; margin-bottom: 15px; }
.cover-progress-section p { margin: 5px 0 0 0; font-size: 14px; }
.play-button { margin-top: 15px; padding: 12px 25px; font-size: 16px; background-color: var(--main-color); color: #fff; border-radius: 6px; display: inline-flex; align-items: center; gap: 8px; text-decoration: none; }
.course-description h1 { font-size: 22px; margin: 15px 0 5px 0; }
.course-description p { font-size: 14px; color: #555; line-height: 1.6; }
.back-admin-btn { display: block; margin-top: 15px; font-size: 14px; text-decoration: none; color: var(--main-color); }

/* Módulos e Aulas na Visão Geral */
.module-list { grid-column: 2 / -1; }
.module-list h2 { font-size: 24px; margin-top: 0; margin-bottom: 20px; }
.module-overview { background: #fff; padding: 25px; border: 1px solid #e0e0e0; border-radius: 8px; margin-bottom: 25px; }
.module-overview h3 { margin-top: 0; margin-bottom: 20px; font-size: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
.lesson-cards-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px; }
.lesson-card { position: relative; /* Necessário para posicionar o tooltip */ background-color: #fff; border: 1px solid #e2e2e2; border-radius: 12px; text-decoration: none; color: #333; transition: all 0.2s ease-in-out; display: flex; flex-direction: column; /* overflow: hidden; <-- REMOVIDO PARA CORRIGIR O TOOLTIP */ }
.lesson-card .lesson-card-link { display: block; text-decoration: none; color: inherit; }
.lesson-card:hover { border-color: var(--main-color); transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.08); }
.card-thumbnail { width: 100%; padding-bottom: 56.25%; background-size: cover; background-position: center; background-color: #eee; border-radius: 11px 11px 0 0; /* Adicionado para manter o design */ }
.card-content { padding: 15px; flex-grow: 1; text-align: left; }
.card-title { font-weight: 600; font-size: 15px; }
.lesson-card.is-completed { border-color: #28a745; }
.lesson-card.is-completed::after { content: '✓'; position: absolute; top: 10px; right: 10px; background-color: #28a745; color: white; border-radius: 50%; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; }
.lesson-card.is-locked { opacity: 0.7; /* pointer-events: none; <-- REMOVIDO */ }

/* NOVO: Overlay para o Content Drip com contagem de dias. */
.content-drip-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(20, 20, 20, 0.75); /* Overlay mais escuro para legibilidade */
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 5;
    text-align: center;
    padding: 10px;
    box-sizing: border-box;
    border-radius: 11px; /* Para corresponder ao border-radius do card pai */
    backdrop-filter: blur(2px); /* Efeito de vidro fosco */
}

.drip-icon-clock {
    font-size: 2.2rem; /* Tamanho base para o ícone */
    width: 1em;
    height: 1em;
    border: 0.1em solid currentColor;
    border-radius: 50%;
    position: relative;
    margin-bottom: 12px;
}

.drip-icon-clock::before,
.drip-icon-clock::after {
    content: '';
    position: absolute;
    background-color: currentColor;
    transform-origin: bottom center;
}

.drip-icon-clock::before { /* Ponteiro das horas */
    top: 0.2em;
    left: 0.45em;
    width: 0.1em;
    height: 0.3em;
}

.drip-icon-clock::after { /* Ponteiro dos minutos */
    top: 0.15em;
    left: 0.45em;
    width: 0.1em;
    height: 0.35em;
    transform: rotate(120deg);
}

.drip-release-text {
    font-size: 1.1rem;
    font-weight: 500;
    line-height: 1.4;
    color: rgba(255, 255, 255, 0.95);
    text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
}

.drip-release-text .drip-days-number {
    font-size: 1.8rem;
    font-weight: 700;
    color: #fff;
    display: inline-block;
    margin: 0 5px;
    vertical-align: -3px; /* Alinha o número melhor com o texto */
}

/* NOVO: Overlay para bloqueio sequencial */
.sequential-lock-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(20, 20, 20, 0.75);
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 5;
    text-align: center;
    padding: 10px;
    box-sizing: border-box;
    border-radius: 11px;
    backdrop-filter: blur(2px);
}

/* NOVO: Ícone de cadeado aprimorado */
.lock-icon-padlock {
    position: relative;
    box-sizing: border-box;
    width: 22px;
    height: 18px;
    border-radius: 4px;
    background: currentColor;
    margin-bottom: 20px; /* Aumenta a margem para dar espaço ao arco */
}
.lock-icon-padlock:before {
    content: '';
    position: absolute;
    box-sizing: border-box;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 16px;
    height: 12px;
    border-radius: 8px 8px 0 0;
    border: 3px solid currentColor;
    border-bottom: none;
}

.sequential-lock-overlay .lock-text {
    font-size: 1rem;
    font-weight: 600;
    line-height: 1.3;
    padding: 0 15px;
}

.check-icon, .activity-icon { margin-left: 8px; }


/* ========================================================================
   Responsividade
   ======================================================================== */
@media (max-width: 900px) {
    .course-overview-container { grid-template-columns: 1fr; }
    .course-info-block { position: static; }
}
@media (max-width: 768px) {
    main, .tutor-ead-page-body main { padding:0px; flex-direction: column; }
    /* Faz com que os containers ocupem a largura total e remove margens desnecessárias */
  .video-container { margin-right: 0; margin-bottom: 20px; padding: 10px; /* Ajusta o padding interno para telas menores */}
  .playlist-section {margin-right: 0; /* Garante que não haja margem lateral */}
}

/* ========================================================================
   ATUALIZAÇÃO FINAL: Estilos para Progresso e Comentários (Layout Limpo)
   ======================================================================== */

/* --- Ajustes na Seção da Barra de Progresso --- */
.progress-section {
    background: none;      /* Remove o fundo cinza */
    border: none;          /* Remove a borda */
    box-shadow: none;      /* Remove qualquer sombra */
    padding-left: 0;       /* Remove espaçamento lateral */
    padding-right: 0;
    margin-left: 0;        /* Garante o alinhamento à esquerda */
    margin-right: 0;
    max-width: 100%;       /* Garante que ocupe a largura disponível */
}

/* ========================================================================
   ATUALIZAÇÃO: Estilos Aprimorados para a Seção de Comentários
   ======================================================================== */

.comments-section {
    margin-top: 40px;
    padding-top: 20px;
    border-top: 1px solid #e5e5e5; /* Mantém um separador sutil do conteúdo da aula */
    box-shadow: none;
    background: transparent;
    padding-left: 0;
    padding-right: 0;
}

.comments-section h3 {
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 18px;
    color: #1d2327;
}

/* Container do formulário de novo comentário */
.comment-input {
    position: relative;
    margin-bottom: 30px;
}

/* Estilo do campo de texto */
.comment-input input[type="text"] {
    width: 100%;
    border: none;
    border-bottom: 1px solid #ccc; /* Estilo minimalista, apenas linha inferior */
    background-color: transparent;
    padding: 10px 2px; /* Padding vertical para conforto, horizontal mínimo */
    font-size: 14px;
    transition: border-color 0.2s ease-in-out;
}

/* Efeito de foco no campo de texto */
.comment-input input[type="text"]:focus {
    outline: none;
    border-bottom-color: var(--main-color); /* Destaca com a cor principal ao focar */
}

/* Estilo do botão Enviar */
.comment-input button {
    display: none; /* Oculto por padrão */
    margin-top: 10px;
    float: right; /* Alinha o botão à direita */
    padding: 8px 20px;
    border: none;
    background: var(--main-color);
    color: #fff;
    cursor: pointer;
    border-radius: 5px;
    font-size: 14px;
    font-weight: bold;
}

/* MÁGICA: Mostra o botão quando o container do input está em foco */
.comment-input:focus-within button {
    display: inline-block;
}

/* Limpa o float do botão */
.comment-input::after {
    content: "";
    display: table;
    clear: both;
}


/* Lista de comentários existentes */
#comments-list {
    display: flex;
    flex-direction: column;
    gap: 15px; /* Espaçamento entre os comentários */
    margin-top: 20px;
    border: none;
    background: none;
}

.comment {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #f0f0f0; /* Separador mais suave */
    background-color: transparent;
}

.comment:last-child {
    border-bottom: none;
}

.comment .comment-text {
    flex-grow: 1;
    line-height: 1.5;
    font-size: 14px;
}

.comment .comment-text strong {
    color: #1d2327;
    font-weight: 600;
}

.comment .comment-date {
    font-size: 12px;
    color: #777;
    white-space: nowrap;
    flex-shrink: 0;
}

/* ========================================================================
   ATUALIZAÇÃO: Estilos para o Card de Comentário
   ======================================================================== */

#comments-list {
    display: flex;
    flex-direction: column;
    gap: 20px; /* Aumenta o espaço entre os comentários */
    margin-top: 25px;
    border: none;
    background: none;
}

/* Container de um comentário individual */
.comment {
    display: flex;
    gap: 15px; /* Espaço entre o avatar e o conteúdo */
    align-items: flex-start;
    padding: 0;
    border: none; /* Remove bordas antigas */
    background: none;
}

/* O círculo para a foto de perfil */
.comment-avatar {
    flex-shrink: 0; /* Impede que o avatar encolha */
}

.comment-avatar img {
    width: 44px;
    height: 44px;
    border-radius: 50%; /* Deixa a imagem redonda */
    object-fit: cover; /* Garante que a imagem preencha o círculo */
    border: 1px solid #eee;
}

/* Container principal do texto do comentário */
.comment-main {
    flex-grow: 1;
}

/* Cabeçalho do comentário (autor e data) */
.comment-header {
    display: flex;
    align-items: baseline;
    gap: 10px;
    margin-bottom: 5px;
}

.comment-author {
    font-weight: 600;
    color: #1d2327;
    font-size: 14px;
}

.comment-date {
    font-size: 12px;
    color: #777;
}

/* Corpo do comentário (o texto em si) */
.comment-body {
    font-size: 14px;
    line-height: 1.6;
    color: #3c434a;
}

.no-comments {
    color: #777;
    padding: 10px 0;
}

/* ====================================
   ESTILOS DO TOOLTIP DA PLAYLIST
======================================= */

.playlist-section .lesson-list li {
    position: relative; /* Necessário para o posicionamento do tooltip */
}

.tooltip-bubble {
    visibility: hidden; /* Começa escondido */
    opacity: 0;
    position: absolute;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 8px 12px;
    z-index: 10;
    bottom: 105%; /* Posiciona acima do item */
    left: 50%;
    transform: translateX(-50%);
    min-width: 220px;
    font-size: 13px;
    line-height: 1.4;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    pointer-events: none; /* Para não interferir com o hover no próprio item */
}

/* Setinha do tooltip */
.tooltip-bubble::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    margin-left: -5px;
    border-width: 5px;
    border-style: solid;
    border-color: #333 transparent transparent transparent;
}

/* Classe que torna o tooltip visível */
.tooltip-visible .tooltip-bubble {
    visibility: visible;
    opacity: 1;
}

/* ====================================
   ESTILOS DO MODAL DE TELEFONE
======================================= */

.phone-modal-overlay {
    display: none; /* Começa oculto */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    justify-content: center;
    align-items: center;
}

.phone-modal {
    background-color: #fff;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    width: 90%;
    max-width: 500px;
    text-align: center;
}

.phone-modal h2 {
    margin-top: 0;
    margin-bottom: 15px;
}

.phone-modal p {
    margin-bottom: 20px;
    color: #555;
}

#phone-modal-form {
    display: flex;
    flex-direction: column;
}

#phone-modal-form label {
    display: block;
    margin-bottom: 8px; /* Aumenta o espaço entre o label e o campo */
    font-weight: bold;
    text-align: left;
}

#phone-modal-form input {
    box-sizing: border-box; /* Garante que o padding não aumente a largura total */
    width: 100%;
    padding: 12px;
    margin-bottom: 20px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 16px;
}

#phone-modal-form button {
    padding: 12px 20px;
    border: none;
    background-color: var(--main-color);
    color: #fff;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    font-weight: bold;
    transition: background-color 0.2s;
}

#phone-modal-form button:hover {
    opacity: 0.9;
}

.phone-modal-error {
    color: #d9534f;
    margin-top: 10px;
    font-size: 14px;
    min-height: 1em;
}